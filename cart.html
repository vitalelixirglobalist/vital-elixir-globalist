<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Cart – Vital Elixir Globalist</title>
  <meta name="description" content="Review your selected medicines and proceed to checkout." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="currency-utils.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: '#0284c7',
            medical: '#0f766e',
            slate: '#0f172a'
          },
          boxShadow: {
            soft: '0 10px 30px rgba(15, 23, 42, 0.08)'
          }
        }
      }
    };
  </script>
  <style>
    /* === FORCE RESET FAB ICONS (PAGE-SAFE FIX) === */
body .fab-stack,
body .popup-fab-stack {
  transform: none !important;
  scale: 1 !important;
  zoom: 1 !important;
}

body .fab-icon {
  width: 48px !important;
  height: 48px !important;
}

body .fab-icon svg,
body .fab-icon img {
  width: 22px !important;
  height: 22px !important;
}
    html { scroll-behavior: smooth; }
  </style>
</head>

<body class="text-slate-900 bg-slate-50">
  <!-- Header Placeholder -->
  <div id="header-placeholder"></div>

  <section class="max-w-6xl mx-auto px-4 py-10">
    <div class="flex flex-col gap-2 mb-6">
      <h1 class="text-3xl font-bold">Your Cart Items</h1>
      <p class="text-sm text-slate-600">Review your medicines, update quantities, and proceed securely.</p>
    </div>

    <!-- Login Prompt Overlay -->
    <div id="loginOverlay"
      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white p-6 rounded-xl shadow-lg max-w-sm text-center">
        <h2 class="text-xl font-bold mb-4">Please log in to view your cart</h2>
        <p class="text-sm text-slate-600 mb-6">You must be signed in to access your cart and proceed to
          checkout.</p>
        <button id="loginRedirect"
          class="px-6 py-3 bg-brand text-white rounded-lg hover:bg-blue-700">Login</button>
      </div>
    </div>

    <div id="cartContainer" class="grid gap-6 lg:grid-cols-12">
      <div class="lg:col-span-8 space-y-6">
        <div class="bg-white rounded-2xl shadow-soft border border-slate-100">
          <div class="flex flex-wrap items-center justify-between gap-3 px-6 py-4 border-b border-slate-100">
            <div>
              <h2 class="text-lg font-semibold">Cart Overview</h2>
              <p class="text-xs text-slate-500">All prices are shown per unit with itemized totals.</p>
            </div>
            <a href="products.html"
              class="inline-flex items-center gap-2 text-sm font-medium text-brand hover:text-blue-700">
              Back to Products
            </a>
          </div>
          <div class="px-6 py-4">
            <div class="hidden md:grid grid-cols-12 text-xs uppercase tracking-wide text-slate-500 border-b border-slate-100 pb-3">
              <div class="col-span-5">Product</div>
              <div class="col-span-3">Quantity</div>
              <div class="col-span-4 text-right">Pricing</div>
            </div>
            <div id="cartItems" class="divide-y divide-slate-100"></div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft border border-slate-100 p-6">
          <h3 class="text-lg font-semibold mb-2">Customer Details</h3>
          <p class="text-xs text-slate-500 mb-4">Used for order verification and delivery communication.</p>
          <form id="checkoutForm" class="grid md:grid-cols-2 gap-4">
            <input type="text" id="customerName" placeholder="Full Name" required
              class="border border-slate-200 rounded-lg px-3 py-2" />
            <input type="email" id="customerEmail" placeholder="Email" required
              class="border border-slate-200 rounded-lg px-3 py-2" />
            <input type="text" id="customerPhone" placeholder="Phone / WhatsApp"
              class="border border-slate-200 rounded-lg px-3 py-2" />
            <input type="text" id="customerCountry" placeholder="Country" class="border border-slate-200 rounded-lg px-3 py-2" />
            <textarea id="customerAddress" rows="3" placeholder="Address"
              class="md:col-span-2 border border-slate-200 rounded-lg px-3 py-2"></textarea>
            <button type="button" id="payButton"
              class="md:col-span-2 mt-2 bg-brand text-white px-6 py-3 rounded-xl hover:bg-blue-700">Proceed to
              Payment</button>
          </form>
        </div>
      </div>

      <div class="lg:col-span-4 space-y-6">
        <div id="cartSummary" class="bg-white rounded-2xl shadow-soft border border-slate-100 p-5"></div>

        <div class="bg-white rounded-2xl shadow-soft border border-slate-100 p-5">
          <h3 class="text-base font-semibold mb-3">Coupon & Loyalty</h3>
          <div class="space-y-3">
            <input type="text" id="loyaltyCode" placeholder="Loyalty customer coupon"
              class="w-full border border-slate-200 rounded-lg px-3 py-2 text-sm" />
            <input type="text" id="promoCode" placeholder="Promotional coupon"
              class="w-full border border-slate-200 rounded-lg px-3 py-2 text-sm" />
            <button type="button" id="applyCoupon"
              class="w-full bg-slate-900 text-white rounded-lg py-2 text-sm hover:bg-slate-800">Apply Coupon</button>
            <p id="couponMessage" class="text-xs text-slate-500"></p>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-soft border border-slate-100 p-5">
          <h3 class="text-base font-semibold mb-2">Consult a Doctor</h3>
          <p class="text-xs text-slate-500 mb-4">Get expert guidance on dosage, interactions, and suitability for your health profile.</p>
          <button type="button"
            class="w-full border border-medical text-medical rounded-lg py-2 text-sm font-semibold hover:bg-emerald-50">Consult a Doctor for this medication</button>
        </div>

        <div class="bg-white rounded-2xl shadow-soft border border-slate-100 p-5 space-y-3">
          <a href="checkout.html"
            class="block text-center bg-brand text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-700">Proceed to Checkout</a>
          <button type="button" id="setReminder"
            class="w-full border border-slate-200 rounded-xl py-2 text-sm text-slate-700 hover:border-slate-300">Set Reminder / Checkout Later</button>
          <p id="reminderMessage" class="text-xs text-slate-500"></p>
        </div>
      </div>
    </div>
  </section>

  <!-- Razorpay script -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <script>
    // Load header and mobile menu
    async function loadHeader() {
      const header = await fetch('header.html');
      document.getElementById('header-placeholder').innerHTML = await header.text();
      if (window.initCurrencySelect) {
        window.initCurrencySelect();
      }
      const menuBtn = document.getElementById('menu-btn');
      const closeBtn = document.getElementById('close-menu');
      const mobileMenu = document.getElementById('mobile-menu');
      const sidebar = document.getElementById('sidebar');
      if (menuBtn && sidebar && mobileMenu) {
        menuBtn.addEventListener('click', () => {
          mobileMenu.classList.remove('hidden');
          setTimeout(() => sidebar.classList.remove('translate-x-full'), 10);
        });
        closeBtn.addEventListener('click', () => {
          sidebar.classList.add('translate-x-full');
          setTimeout(() => mobileMenu.classList.add('hidden'), 300);
        });
        mobileMenu.addEventListener('click', (e) => {
          if (e.target === mobileMenu) {
            sidebar.classList.add('translate-x-full');
            setTimeout(() => mobileMenu.classList.add('hidden'), 300);
          }
        });
      }
    }
    loadHeader();
  </script>

  <script type="module">
    import { auth, db } from './firebase-config.js';
    import { onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js';
    import { collection, addDoc, getDocs, deleteDoc, doc, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js';
    const SHIPPING_USD = 35;

    const getSelectedCurrency = () => window.currencyUtils?.getSelectedCurrency?.() || 'GBP';

    const formatForeignCurrency = (value) => {
      const currency = getSelectedCurrency();
      const converted = window.currencyUtils?.convertFromUsd
        ? window.currencyUtils.convertFromUsd(value, currency)
        : value;
      return `${currency} ${Number(converted || 0).toFixed(2)}`;
    };

    const calculateShippingInr = (medicineUsd, medicineInr, existingShippingInr) => {
      if (existingShippingInr !== undefined && existingShippingInr !== null) {
        return Number(existingShippingInr);
      }
      if (!medicineUsd) return 0;
      const rate = medicineInr / medicineUsd;
      const computed = rate * SHIPPING_USD;
      return parseFloat(computed.toFixed(2));
    };

    const calculateLineTotals = (item, quantity) => {
      const medicineUsd = Number(item.price_usd || 0);
      const medicineInr = Number(item.price_inr || 0);
      const shippingUsd = item.shipping_usd !== undefined && item.shipping_usd !== null
        ? Number(item.shipping_usd)
        : SHIPPING_USD;
      const shippingInr = calculateShippingInr(medicineUsd, medicineInr, item.shipping_inr);
      const lineMedicineUsd = parseFloat((medicineUsd * quantity).toFixed(2));
      const lineMedicineInr = parseFloat((medicineInr * quantity).toFixed(2));
      const lineShippingUsd = parseFloat((shippingUsd * quantity).toFixed(2));
      const lineShippingInr = parseFloat((shippingInr * quantity).toFixed(2));
      const totalUsd = parseFloat((lineMedicineUsd + lineShippingUsd).toFixed(2));
      const totalInr = parseFloat((lineMedicineInr + lineShippingInr).toFixed(2));
      return {
        medicineUsd,
        medicineInr,
        shippingUsd,
        shippingInr,
        lineMedicineUsd,
        lineMedicineInr,
        lineShippingUsd,
        lineShippingInr,
        totalUsd,
        totalInr
      };
    };

    const getQuantity = (item) => Number(item.quantity || item.qty || item.count || 1);

    const getPackCount = (item) => {
      if (!item.pack) return null;
      const match = String(item.pack).match(/(\d+)\s*(tablet|capsule|tab|cap)/i);
      return match ? Number(match[1]) : null;
    };

    const getStrength = (item) => {
      const strengthMatch = String(item.pack || '').match(/(\d+\s?mg|\d+\s?mcg|\d+\s?ml)/i);
      return item.strength || item.dosage || (strengthMatch ? strengthMatch[1] : 'Standard strength');
    };

    // Elements
    const loginOverlay = document.getElementById('loginOverlay');
    const loginRedirect = document.getElementById('loginRedirect');
    const cartItemsDiv = document.getElementById('cartItems');
    const cartSummaryDiv = document.getElementById('cartSummary');
    const payButton = document.getElementById('payButton');
    const applyCouponBtn = document.getElementById('applyCoupon');
    const couponMessage = document.getElementById('couponMessage');
    const reminderMessage = document.getElementById('reminderMessage');
    const reminderBtn = document.getElementById('setReminder');

    let currentUser = null;
    let hasSyncedLocalCart = false;
    let discountRate = 0;

    onAuthStateChanged(auth, async (user) => {
      currentUser = user;
      if (!user) {
        loginOverlay.classList.remove('hidden');
        await renderCart();
      } else {
        loginOverlay.classList.add('hidden');
        document.getElementById('cartContainer').classList.remove('hidden');
        document.getElementById('customerEmail').value = user.email;
        await syncLocalCartOnce(user.uid);
        await renderCart();
      }
    });

    loginRedirect.addEventListener('click', () => {
      window.location.href = 'login.html?redirect=cart.html';
    });

    const getLocalCart = () => JSON.parse(localStorage.getItem('cart')) || [];

    const getProductId = (item) => {
      if (item.productId) return String(item.productId);
      if (item.id && typeof item.id === 'string') return item.id;
      const base = `${item.name || 'item'}-${item.brand || 'brand'}-${item.pack || 'pack'}`;
      return base
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, '-')
        .replace(/(^-|-$)/g, '');
    };

    const normalizeFirestoreItem = async (uid, docSnap) => {
      const data = docSnap.data();
      const productId = getProductId({ ...data, id: docSnap.id });
      if (docSnap.id !== productId) {
        const targetRef = doc(db, 'users', uid, 'cart', productId);
        const existing = await getDoc(targetRef);
        if (!existing.exists()) {
          await setDoc(targetRef, { ...data, id: productId }, { merge: true });
        }
        await deleteDoc(doc(db, 'users', uid, 'cart', docSnap.id));
      }
      return { id: productId, ...data };
    };

    const fetchFirestoreCart = async (uid) => {
      const snapshot = await getDocs(collection(db, 'users', uid, 'cart'));
      const items = [];
      for (const docSnap of snapshot.docs) {
        items.push(await normalizeFirestoreItem(uid, docSnap));
      }
      return items;
    };

    const syncLocalCartOnce = async (uid) => {
      if (hasSyncedLocalCart) return;
      const sessionKey = `cartSynced:${uid}`;
      if (sessionStorage.getItem(sessionKey)) {
        hasSyncedLocalCart = true;
        return;
      }
      const localCart = getLocalCart();
      if (localCart.length === 0) {
        sessionStorage.setItem(sessionKey, 'true');
        hasSyncedLocalCart = true;
        return;
      }
      const existingDocs = await getDocs(collection(db, 'users', uid, 'cart'));
      const existingIds = new Set(existingDocs.docs.map((docSnap) => docSnap.id));
      for (const item of localCart) {
        const productId = getProductId(item);
        if (existingIds.has(productId)) {
          continue;
        }
        await setDoc(doc(db, 'users', uid, 'cart', productId), { ...item, id: productId }, { merge: true });
      }
      localStorage.removeItem('cart');
      sessionStorage.setItem(sessionKey, 'true');
      hasSyncedLocalCart = true;
    };

    const updateCartItemQuantity = async (item, index, nextQty) => {
      if (!currentUser) {
        const localCart = getLocalCart();
        if (index >= 0 && index < localCart.length) {
          localCart[index].quantity = nextQty;
          localStorage.setItem('cart', JSON.stringify(localCart));
        }
        return;
      }
      const productId = getProductId(item);
      await setDoc(doc(db, 'users', currentUser.uid, 'cart', productId), { quantity: nextQty }, { merge: true });
    };

    async function renderCart() {
      cartItemsDiv.innerHTML = '';
      cartSummaryDiv.innerHTML = '';
      let subtotalINR = 0;
      let subtotalUSD = 0;
      let shippingTotalINR = 0;
      let shippingTotalUSD = 0;

      let cartItems = [];
      if (currentUser) {
        cartItems = await fetchFirestoreCart(currentUser.uid);
      } else {
        cartItems = getLocalCart();
      }

      if (cartItems.length === 0) {
        cartItemsDiv.innerHTML = '<div class="py-10 text-center text-slate-500">Your cart is empty.</div>';
        cartSummaryDiv.innerHTML = '<p class="text-sm text-slate-500">No items to summarize.</p>';
        return;
      }

      cartItems.forEach((item, index) => {
        const quantity = Math.max(1, getQuantity(item));
        const packCount = getPackCount(item);
        const strength = getStrength(item);
        const {
          medicineUsd,
          medicineInr,
          shippingUsd,
          shippingInr,
          lineMedicineUsd,
          lineMedicineInr,
          lineShippingUsd,
          lineShippingInr,
          totalUsd,
          totalInr
        } = calculateLineTotals(item, quantity);

        subtotalINR += lineMedicineInr;
        subtotalUSD += lineMedicineUsd;
        shippingTotalINR += lineShippingInr;
        shippingTotalUSD += lineShippingUsd;

        const tabletDisplay = packCount ? `${packCount * quantity} tablets` : `${quantity} units`;

        const itemDiv = document.createElement('div');
        itemDiv.className = 'grid gap-4 py-6 md:grid-cols-12 items-center';
        itemDiv.innerHTML = `
          <div class="md:col-span-5 flex gap-4 items-start">
            <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-contain rounded-lg border border-slate-100 bg-white" />
            <div class="space-y-1">
              <h3 class="font-semibold text-sm">${item.name}</h3>
              <p class="text-xs text-slate-500">Strength: ${strength}</p>
              <p class="text-xs text-slate-500">Pack: ${item.pack || 'Standard pack'}</p>
              <div class="flex flex-wrap gap-2 mt-3 text-xs">
                <button class="text-red-500 hover:text-red-600 removeItemBtn" data-index="${index}">Remove</button>
                <button class="text-slate-500 hover:text-slate-700 saveLaterBtn" data-index="${index}">Save for later</button>
                <button class="text-slate-500 hover:text-slate-700 checkoutLaterBtn" data-index="${index}">Checkout later</button>
              </div>
            </div>
          </div>
          <div class="md:col-span-3">
            <div class="flex items-center gap-2">
              <button class="qtyBtn w-8 h-8 rounded-full border border-slate-200 hover:border-slate-400" data-index="${index}" data-direction="-">−</button>
              <div class="text-sm font-semibold px-3">${quantity}</div>
              <button class="qtyBtn w-8 h-8 rounded-full border border-slate-200 hover:border-slate-400" data-index="${index}" data-direction="+">+</button>
            </div>
            <p class="text-xs text-slate-500 mt-1">${tabletDisplay}</p>
          </div>
          <div class="md:col-span-4 text-sm text-right space-y-1">
            <p class="text-slate-500">Price per unit: ${formatForeignCurrency(medicineUsd)} | INR ${medicineInr.toFixed(2)}</p>
            <p class="text-slate-500">Subtotal: ${formatForeignCurrency(lineMedicineUsd)} | INR ${lineMedicineInr.toFixed(2)}</p>
            <p class="text-slate-500">Shipping: ${formatForeignCurrency(lineShippingUsd)} | INR ${lineShippingInr.toFixed(2)}</p>
            <p class="font-semibold text-brand">Item total: ${formatForeignCurrency(totalUsd)} | INR ${totalInr.toFixed(2)}</p>
          </div>
        `;
        cartItemsDiv.appendChild(itemDiv);
      });

      const taxUSD = 0;
      const taxINR = 0;
      const discountUSD = parseFloat((subtotalUSD * discountRate).toFixed(2));
      const discountINR = parseFloat((subtotalINR * discountRate).toFixed(2));
      const grandTotalUSD = subtotalUSD + shippingTotalUSD + taxUSD - discountUSD;
      const grandTotalINR = subtotalINR + shippingTotalINR + taxINR - discountINR;

      cartSummaryDiv.innerHTML = `
        <div class="space-y-3">
          <div class="flex items-center justify-between text-sm">
            <span class="text-slate-600">Medication total</span>
            <span class="font-medium">${formatForeignCurrency(subtotalUSD)} | INR ${subtotalINR.toFixed(2)}</span>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-slate-600">Shipping charges</span>
            <span class="font-medium">${formatForeignCurrency(shippingTotalUSD)} | INR ${shippingTotalINR.toFixed(2)}</span>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-slate-600">Tax</span>
            <span class="font-medium">${formatForeignCurrency(taxUSD)} | INR ${taxINR.toFixed(2)}</span>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-slate-600">Discount</span>
            <span class="font-medium">- ${formatForeignCurrency(discountUSD)} | INR ${discountINR.toFixed(2)}</span>
          </div>
          <div class="border-t border-slate-200 pt-3 flex items-center justify-between">
            <span class="text-base font-semibold">Final payable amount</span>
            <span class="text-lg font-bold text-brand">${formatForeignCurrency(grandTotalUSD)} | INR ${grandTotalINR.toFixed(2)}</span>
          </div>
          <p class="text-xs text-slate-500">Shipping estimates are based on standard delivery for each item.</p>
        </div>
      `;

      document.querySelectorAll('.removeItemBtn').forEach((btn) => {
        btn.addEventListener('click', async (e) => {
          const idx = parseInt(e.target.getAttribute('data-index'));
          const toRemove = cartItems[idx];
          if (!toRemove) return;
          if (!currentUser) {
            const localCart = getLocalCart();
            localCart.splice(idx, 1);
            localStorage.setItem('cart', JSON.stringify(localCart));
          } else {
            await deleteDoc(doc(db, 'users', currentUser.uid, 'cart', getProductId(toRemove)));
          }
          renderCart();
        });
      });

      document.querySelectorAll('.qtyBtn').forEach((btn) => {
        btn.addEventListener('click', async (e) => {
          const idx = parseInt(e.currentTarget.getAttribute('data-index'));
          const direction = e.currentTarget.getAttribute('data-direction');
          const currentItem = cartItems[idx];
          const currentQty = Math.max(1, getQuantity(currentItem));
          const nextQty = direction === '+' ? currentQty + 1 : Math.max(1, currentQty - 1);
          await updateCartItemQuantity(currentItem, idx, nextQty);
          renderCart();
        });
      });

      document.querySelectorAll('.saveLaterBtn, .checkoutLaterBtn').forEach((btn) => {
        btn.addEventListener('click', () => {
          reminderMessage.textContent = 'Saved. You can return to complete checkout anytime.';
          setTimeout(() => {
            reminderMessage.textContent = '';
          }, 3000);
        });
      });
    }

    document.addEventListener('currency:change', () => {
      renderCart();
    });

    applyCouponBtn.addEventListener('click', () => {
      const loyaltyCode = document.getElementById('loyaltyCode').value.trim();
      const promoCode = document.getElementById('promoCode').value.trim();
      if (!loyaltyCode && !promoCode) {
        discountRate = 0;
        couponMessage.textContent = 'Enter a loyalty or promotional coupon to apply.';
        renderCart();
        return;
      }
      discountRate = 0.05;
      couponMessage.textContent = 'Coupon applied successfully. Discount reflected in totals.';
      renderCart();
    });

    reminderBtn.addEventListener('click', () => {
      reminderMessage.textContent = 'We will keep your cart ready. You can resume checkout later.';
      setTimeout(() => {
        reminderMessage.textContent = '';
      }, 4000);
    });

    // Payment integration
    payButton.addEventListener('click', async () => {
      if (!currentUser) {
        loginOverlay.classList.remove('hidden');
        return;
      }
      const cart = await fetchFirestoreCart(currentUser.uid);
      if (cart.length === 0) {
        alert('Your cart is empty. Please add products before checkout.');
        return;
      }
      const name = document.getElementById('customerName').value.trim();
      const email = document.getElementById('customerEmail').value.trim();
      const phone = document.getElementById('customerPhone').value.trim();
      const country = document.getElementById('customerCountry').value.trim();
      const address = document.getElementById('customerAddress').value.trim();
      if (!name || !email) {
        alert('Please provide your name and email.');
        return;
      }
      let totalINR = 0;
      cart.forEach(item => {
        const quantity = Math.max(1, getQuantity(item));
        const { totalInr } = calculateLineTotals(item, quantity);
        totalINR += totalInr;
      });
      totalINR = totalINR - totalINR * discountRate;
      const amountPaise = Math.round(totalINR * 100);
      const options = {
        key: 'RAZORPAY_KEY_ID',
        amount: amountPaise,
        currency: 'INR',
        name: 'Vital Elixir Globalist',
        description: 'Purchase of Medicines',
        handler: async function (response) {
          const orderData = {
            items: cart,
            date: new Date().toISOString(),
            status: 'success',
            orderId: response.razorpay_payment_id,
            trackingId: '',
            customer: {
              name: name,
              email: email,
              phone: phone,
              country: country,
              address: address
            }
          };
          try {
            await addDoc(collection(db, 'users', currentUser.uid, 'orders'), orderData);
          } finally {
            for (const item of cart) {
              await deleteDoc(doc(db, 'users', currentUser.uid, 'cart', getProductId(item)));
            }
          }
          const mailBody = encodeURIComponent(`New order placed by ${name} (Email: ${email}).\n\nItems:\n${cart.map(i => i.name + ' - ' + i.pack).join(', ')}\nTotal INR: ${totalINR}\nOrder ID: ${response.razorpay_payment_id}`);
          window.open(`mailto:vitalelixirglobalist@gmail.com?subject=New Order&body=${mailBody}`);
          window.location.href = 'thankyou.html';
        },
        prefill: {
          name: name,
          email: email,
          contact: phone
        },
        notes: {
          address: address,
          country: country
        },
        theme: {
          color: '#0284c7'
        }
      };
      const rzp = new Razorpay(options);
            rzp.open();
    });
  </script>
</body>
</html>
