<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Products â€“ Vital Elixir Globalist</title>
  <meta name="description" content="Explore genuine medicines by category â€“ Tablets, Creams, Drops, Sprays, and Injections." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: { colors: { brand: '#0284c7' } }
      }
    }
  </script>
</head>

<body class="text-gray-800 bg-gray-50">
  <div id="header-placeholder"></div>

  <!-- Page Title -->
  <section class="text-center py-10 bg-gradient-to-b from-blue-50 to-white">
    <h1 class="text-4xl font-extrabold text-gray-900">Our Medicines</h1>
    <p class="text-gray-600 mt-2">Explore by category and add to your cart for quick checkout</p>
  </section>

  <!-- Search & Category Filter -->
  <div class="max-w-6xl mx-auto px-4 mb-8 flex flex-col md:flex-row md:justify-between md:items-center gap-4">
    <input
      id="searchBar"
      type="text"
      placeholder="Search medicines..."
      class="w-full md:w-1/2 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-brand"
    />
    <select id="categoryFilter" class="border rounded p-2">
  <option value="all">All Categories</option>
  <option value="Menâ€™s Health">Menâ€™s Health</option>
  <option value="Diabetes & Metabolic Care">Diabetes & Metabolic Care</option>
  <option value="Dermatology & Skin Care">Dermatology & Skin Care</option>
  <option value="Eye & Allergy Care">Eye & Allergy Care</option>
  <option value="Hormonal & Thyroid Care">Hormonal & Thyroid Care</option>
  <option value="Hormonal / Performance Enhancement">Hormonal / Performance Enhancement</option>
  <option value="Infection & Antiparasitic Treatments">Infection & Antiparasitic Treatments</option>
  <option value="Neurology">Neurology</option>
  <option value="Thyroid Treatment">Thyroid Treatment</option>
  <option value="Allergy / Anxiety">Allergy / Anxiety</option>
  <option value="Anti-Malarial / Autoimmune">Anti-Malarial / Autoimmune</option>
  <option value="Addiction Treatment">Addiction Treatment</option>
  <option value="Anticoagulant">Anticoagulant</option>
  <option value="Veterinary / Other Uses">Veterinary / Other Uses</option>
  <option value="Veterinary / Antiparasitic">Veterinary / Antiparasitic</option>
  <option value="Hormone Therapy">Hormone Therapy</option>
  <option value="Supplement">Supplement</option>
  <option value="Allergy / Asthma">Allergy / Asthma</option>
</select>
  </div>

  <!-- Product Grid -->
  <div id="productGrid" class="max-w-6xl mx-auto grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 px-4 pb-16"></div>

  <!-- Footer -->
  <footer class="py-8 bg-white border-t text-center text-gray-600 text-sm">
    Â© <span id="year"></span> Vital Elixir Globalist. All rights reserved.
  </footer>

  <!-- Script -->
  <script>
    // Set footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    let allProducts = [];
    const productGrid = document.getElementById('productGrid');
    const searchBar = document.getElementById('searchBar');
    const categoryFilter = document.getElementById('categoryFilter');

    async function loadProducts() {
      const res = await fetch('products-data.json');
      allProducts = await res.json();
      displayProducts(allProducts);
    }

    function displayProducts(products) {
      productGrid.innerHTML = '';
      products.forEach((p) => {
        const card = document.createElement('div');
        card.className = 'bg-white border rounded-xl p-4 shadow-sm hover:shadow-lg transition flex flex-col';
        const dropdownOptions = p.variants
          .map((v) => `<option value="${p.variants.indexOf(v)}">${v.pack}</option>`)
          .join('');
        card.innerHTML = `
          <img src="${p.image}" alt="${p.name}" class="w-full h-40 object-contain mb-3 rounded" />
          <h2 class="font-semibold text-lg text-brand">${p.name}</h2>
          <p class="text-sm text-gray-600">${p.brand}</p>
          <p class="text-sm text-gray-500 mb-2">${p.composition}</p>
          <p class="text-sm text-gray-600 mb-1"><strong>Use:</strong> ${p.use}</p>
          <select class="variantSelect border mt-2 p-2 rounded w-full text-sm focus:ring-2 focus:ring-brand">
            <option disabled selected>Order Quantity</option>
            ${dropdownOptions}
          </select>
          <div class="price-display mt-3 text-sm text-gray-700"></div>
          <button class="add-to-cart-btn mt-auto bg-brand text-white py-2 px-3 rounded-lg hover:bg-blue-700 transition mt-3">Add to Cart</button>
        `;
        const select = card.querySelector('.variantSelect');
        const priceDisplay = card.querySelector('.price-display');
        const addBtn = card.querySelector('.add-to-cart-btn');
        select.addEventListener('change', (e) => {
          const variant = p.variants[e.target.value];
          priceDisplay.innerHTML = `
            <div class="mt-2 p-2 border border-blue-100 rounded-lg bg-blue-50 text-sm">
              ðŸ’µ <span class="font-medium text-brand">USD ${variant.price_usd}</span>
              | ðŸ‡®ðŸ‡³ <span class="font-medium text-brand">INR ${variant.price_inr}</span>
            </div>
          `;
        });
        addBtn.addEventListener('click', () => {
          const variantIndex = select.selectedIndex - 1;
          if (variantIndex < 0) {
            alert('Please select a quantity before adding to cart.');
            return;
          }
          addToCart(p, variantIndex);
        });
        productGrid.appendChild(card);
      });
    }

    function addToCart(product, variantIndex) {
      if (variantIndex < 0) {
        alert('Please select a quantity before adding to cart.');
        return;
      }
      // Ensure user email is captured
      let userEmail = localStorage.getItem('userEmail');
      if (!userEmail) {
        userEmail = prompt('Please enter your email to continue');
        if (!userEmail) {
          alert('Email is required to add items to cart.');
          return;
        }
        localStorage.setItem('userEmail', userEmail.trim());
      }
      const selectedVariant = product.variants[variantIndex];
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.push({
        name: product.name,
        brand: product.brand,
        pack: selectedVariant.pack,
        price_usd: selectedVariant.price_usd,
        price_inr: selectedVariant.price_inr,
        image: product.image
      });
      localStorage.setItem('cart', JSON.stringify(cart));
      alert(`${product.name} (${selectedVariant.pack}) added to cart!`);
    }

    // ðŸ” Search + Filter
    searchBar.addEventListener('input', () => filterProducts());
    categoryFilter.addEventListener('change', () => filterProducts());

    function filterProducts() {
      const query = searchBar.value.toLowerCase();
      const category = categoryFilter.value;
      const filtered = allProducts.filter(p =>
        (category === 'all' || p.category === category) &&
        (p.name.toLowerCase().includes(query) || p.brand.toLowerCase().includes(query))
      );
      displayProducts(filtered);
    }

    loadProducts();

    // âœ… Load header + mobile menu functionality
    async function loadHeader() {
      const header = await fetch('header.html');
      document.getElementById('header-placeholder').innerHTML = await header.text();
      const menuBtn = document.getElementById('menu-btn');
      const closeBtn = document.getElementById('close-menu');
      const mobileMenu = document.getElementById('mobile-menu');
      const sidebar = document.getElementById('sidebar');
      if (!menuBtn || !sidebar || !mobileMenu) return;
      menuBtn.addEventListener('click', () => {
        mobileMenu.classList.remove('hidden');
        setTimeout(() => sidebar.classList.remove('translate-x-full'), 10);
      });
      closeBtn.addEventListener('click', () => {
        sidebar.classList.add('translate-x-full');
        setTimeout(() => mobileMenu.classList.add('hidden'), 300);
      });
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) {
          sidebar.classList.add('translate-x-full');
          setTimeout(() => mobileMenu.classList.add('hidden'), 300);
        }
      });
    }
    loadHeader();
  </script>
</body>
</html>

