<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medication Details ‚Äì Vital Elixir Globalist</title>
  <meta name="description" content="See complete medication details, pricing, pack sizes, and trusted export quality information." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { brand: '#0284c7' },
          boxShadow: {
            glow: '0 12px 45px rgba(2, 132, 199, 0.18)'
          }
        }
      }
    };
  </script>
  <style>
    @keyframes floatIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-up { animation: floatIn 0.6s ease-out; }
    .glass-card { background: rgba(255, 255, 255, 0.92); backdrop-filter: blur(12px); }
  </style>
</head>

<body class="bg-slate-50 text-slate-800">
  <div id="header-placeholder"></div>

  <main class="max-w-6xl mx-auto px-4 pb-24 pt-10 space-y-12">
    <section class="grid lg:grid-cols-2 gap-10 items-start">
      <div class="relative group fade-up">
        <div class="absolute -inset-2 rounded-3xl bg-gradient-to-br from-brand/20 to-blue-200 blur-2xl opacity-50 group-hover:opacity-80 transition"></div>
        <div class="relative glass-card rounded-3xl p-6 shadow-glow">
          <div class="flex items-center justify-between text-xs font-semibold text-brand">
            <span class="px-3 py-1 rounded-full bg-blue-50 border border-blue-100">Worldwide availability</span>
            <span class="px-3 py-1 rounded-full bg-emerald-50 border border-emerald-100 text-emerald-700">Export quality verified</span>
          </div>
          <div class="mt-6 bg-slate-100 rounded-2xl p-6 flex items-center justify-center">
            <img id="product-image" src="" alt="Medication image" class="max-h-80 w-auto object-contain drop-shadow-lg" />
          </div>
        </div>
      </div>

      <div class="space-y-6 fade-up" style="animation-delay: 0.1s;">
        <div class="space-y-3">
          <div class="flex flex-wrap items-center gap-3 text-sm">
            <span id="product-category" class="px-3 py-1 rounded-full bg-blue-100 text-brand font-semibold"></span>
            <span class="px-3 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100">Consult-ready</span>
          </div>
          <h1 id="product-name" class="text-4xl font-extrabold text-slate-900 leading-tight"></h1>
          <p id="product-use" class="text-lg text-slate-600"></p>
          <div class="flex flex-wrap gap-4 text-sm text-slate-600">
            <span id="product-brand" class="inline-flex items-center gap-2"><span class="text-brand">üè∑Ô∏è</span><span></span></span>
            <span id="product-composition" class="inline-flex items-center gap-2"><span class="text-brand">üß™</span><span></span></span>
          </div>
        </div>

        <div class="glass-card rounded-3xl p-6 shadow-glow space-y-5">
          <div class="grid md:grid-cols-2 gap-4">
            <label class="flex flex-col gap-2 text-sm font-semibold text-slate-700">
              <span class="flex items-center gap-2"><span class="text-brand">üíä</span>Dosage / strength</span>
              <select id="dosageSelect" class="w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand text-sm"></select>
            </label>
            <label class="flex flex-col gap-2 text-sm font-semibold text-slate-700">
              <span class="flex items-center gap-2"><span class="text-brand">üì¶</span>Pack size</span>
              <select id="packSelect" class="w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand text-sm"></select>
            </label>
          </div>

          <div id="priceBreakdown" class="rounded-2xl border border-blue-100 bg-blue-50 p-4 text-sm text-slate-700"></div>

          <div class="flex flex-wrap gap-3">
            <button id="addToCartBtn" class="px-5 py-3 bg-brand text-white rounded-xl hover:bg-blue-700 transition shadow-glow">
              Add to Cart
            </button>
            <button id="consultBtn" class="px-5 py-3 border border-brand text-brand rounded-xl hover:bg-blue-50 transition">
              Consult Doctor for Dosage & Usage
            </button>
          </div>
          <p class="text-xs text-slate-500 flex items-start gap-2">
            <span class="text-brand">üîí</span>
            <span>Our pharmacists review every order. We recommend confirming dosage with a licensed doctor before purchase.</span>
          </p>
        </div>
      </div>
    </section>

    <section class="space-y-4 fade-up" id="relatedSection">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-xs uppercase tracking-wide text-brand font-semibold">Similar options</p>
          <h2 class="text-2xl font-bold text-slate-900">Similar medications from the same category</h2>
        </div>
        <span class="text-sm text-slate-500">Tap any card to open full details</span>
      </div>
      <div id="relatedGrid" class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4"></div>
    </section>

    <section class="space-y-4 fade-up" id="pairingsSection">
      <div class="flex items-center gap-2 text-brand text-sm font-semibold"><span>ü§ù</span><span>Commonly prescribed with</span></div>
      <div id="pairingsGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </section>
  </main>

  <div id="actionToast" class="hidden fixed top-4 right-4 bg-slate-900 text-white px-4 py-3 rounded-xl shadow-lg text-sm"></div>

  <div id="mobileActionBar" class="hidden fixed md:hidden bottom-0 inset-x-0 bg-white/95 border-t border-slate-200 p-4 flex gap-3 z-40">
    <button class="flex-1 px-4 py-3 bg-brand text-white rounded-xl" onclick="addToCart()">Add to Cart</button>
    <button class="flex-1 px-4 py-3 border border-brand text-brand rounded-xl" onclick="consultDoctor()">Consult</button>
  </div>

  <footer class="py-8 bg-white border-t text-center text-slate-500 text-sm">
    ¬© <span id="year"></span> Vital Elixir Globalist. All rights reserved.
  </footer>

  <script>
    const SHIPPING_USD = 35;
    let allProducts = [];
    let selectedProduct = null;
    let selectedVariantIndex = 0;

    const productImage = document.getElementById('product-image');
    const productName = document.getElementById('product-name');
    const productBrand = document.getElementById('product-brand');
    const productComposition = document.getElementById('product-composition');
    const productCategory = document.getElementById('product-category');
    const productUse = document.getElementById('product-use');
    const dosageSelect = document.getElementById('dosageSelect');
    const packSelect = document.getElementById('packSelect');
    const priceBreakdown = document.getElementById('priceBreakdown');
    const relatedGrid = document.getElementById('relatedGrid');
    const pairingsGrid = document.getElementById('pairingsGrid');
    const actionToast = document.getElementById('actionToast');
    const mobileActionBar = document.getElementById('mobileActionBar');

    document.getElementById('year').textContent = new Date().getFullYear();

    function formatMoney(value) {
      return Number(value || 0).toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
    }

    function getSelectedCurrency() {
      return window.currencyUtils?.getSelectedCurrency?.() || 'GBP';
    }

    function formatForeignCurrency(value) {
      const currency = getSelectedCurrency();
      const converted = window.currencyUtils?.convertFromUsd
        ? window.currencyUtils.convertFromUsd(value, currency)
        : value;
      return `${currency} ${formatMoney(converted)}`;
    }

    function showToast(message) {
      if (!actionToast) return alert(message);
      actionToast.textContent = message;
      actionToast.classList.remove('hidden');
      setTimeout(() => actionToast.classList.add('hidden'), 2800);
    }

    function getShippingInr(variant) {
      if (!variant.price_usd || !variant.price_inr) return 0;
      return (variant.price_inr / variant.price_usd) * SHIPPING_USD;
    }

    function updatePrice() {
      if (!selectedProduct || !selectedProduct.variants.length) return;
      const index = Number(packSelect.value) || 0;
      selectedVariantIndex = index;
      const variant = selectedProduct.variants[index] || selectedProduct.variants[0];
      const shippingInr = getShippingInr(variant);
      const totalUsd = (variant.price_usd || 0) + SHIPPING_USD;
      const totalInr = (variant.price_inr || 0) + shippingInr;

      priceBreakdown.innerHTML = `
        <div class="space-y-2">
          <div class="flex items-center justify-between"><span class="font-semibold text-brand">Selected pack</span><span>${variant.pack}</span></div>
          <div class="flex items-center justify-between"><span>Medicine</span><span>${formatForeignCurrency(variant.price_usd)}${variant.price_inr ? ` | INR ${variant.price_inr.toFixed(2)}` : ''}</span></div>
          <div class="flex items-center justify-between"><span>Shipping</span><span>${formatForeignCurrency(SHIPPING_USD)}${variant.price_inr ? ` | INR ${shippingInr.toFixed(2)}` : ''}</span></div>
          <div class="flex items-center justify-between font-bold text-brand text-lg"><span>Total</span><span>${formatForeignCurrency(totalUsd)}${variant.price_inr ? ` | INR ${totalInr.toFixed(2)}` : ''}</span></div>
        </div>
      `;
    }

    function renderSelectors(product) {
      dosageSelect.innerHTML = '';
      const doseOption = document.createElement('option');
      doseOption.value = product.composition;
      doseOption.textContent = product.composition;
      dosageSelect.appendChild(doseOption);

          packSelect.innerHTML = '';
      product.variants.forEach((variant, index) => {
        const opt = document.createElement('option');
        opt.value = index;
        opt.textContent = `${variant.pack} ‚Äî ${formatForeignCurrency(variant.price_usd)}`;
        packSelect.appendChild(opt);
      });
      packSelect.value = '0';
      updatePrice();
    }
    function renderProduct(product) {
      selectedProduct = product;
      productImage.src = product.image;
      productImage.alt = product.name;
      productName.textContent = product.name;
      productBrand.lastElementChild.textContent = product.brand;
      productComposition.lastElementChild.textContent = product.composition;
      productCategory.textContent = product.category;
      productUse.textContent = product.use;

      renderSelectors(product);
      mobileActionBar.classList.remove('hidden');
    }

    function renderRelated(product) {
      relatedGrid.innerHTML = '';
      const related = allProducts.filter((p) => p.category === product.category && p.name !== product.name).slice(0, 4);
      if (!related.length) {
        relatedGrid.innerHTML = '<p class="text-sm text-slate-500">No similar medications available right now.</p>';
        return;
      }
      related.forEach((item) => {
        const card = document.createElement('a');
        card.href = `product-details.html?product=${encodeURIComponent(item.name)}`;
        card.className = 'glass-card p-4 rounded-2xl border border-slate-200 hover:-translate-y-1 transition shadow-sm hover:shadow-lg bg-white';
        card.innerHTML = `
          <div class="flex items-center gap-3">
            <div class="h-14 w-14 rounded-xl bg-slate-100 flex items-center justify-center overflow-hidden">
              <img src="${item.image}" alt="${item.name}" class="h-full w-full object-contain" />
            </div>
            <div class="space-y-1">
              <p class="text-sm text-brand font-semibold">${item.category}</p>
              <h3 class="font-bold text-slate-900 leading-tight">${item.name}</h3>
              <p class="text-xs text-slate-500">${item.brand}</p>
            </div>
          </div>
        `;
        relatedGrid.appendChild(card);
      });
    }

    function renderPairings(product) {
      pairingsGrid.innerHTML = '';
      let pairings = allProducts.filter((p) => p.name !== product.name && p.category !== product.category);
      if (!pairings.length) pairings = allProducts.filter((p) => p.name !== product.name);
      pairings.slice(0, 3).forEach((item) => {
        const card = document.createElement('a');
        card.href = `product-details.html?product=${encodeURIComponent(item.name)}`;
        card.className = 'p-4 rounded-2xl border border-emerald-100 bg-emerald-50/60 hover:bg-emerald-50 transition';
        card.innerHTML = `
          <div class="flex items-start gap-3">
            <div class="mt-1">ü©∫</div>
            <div>
              <p class="text-xs uppercase tracking-wide text-emerald-700 font-semibold">Often paired</p>
              <h3 class="font-bold text-slate-900">${item.name}</h3>
              <p class="text-sm text-slate-600">${item.category}</p>
            </div>
          </div>
        `;
        pairingsGrid.appendChild(card);
      });
    }

    function addToCart() {
      if (!selectedProduct) return showToast('No product selected.');
      const variant = selectedProduct.variants[selectedVariantIndex] || selectedProduct.variants[0];
      const shippingInr = getShippingInr(variant);
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.push({
        name: selectedProduct.name,
        brand: selectedProduct.brand,
        pack: variant.pack,
        price_usd: variant.price_usd,
        price_inr: variant.price_inr,
        shipping_usd: SHIPPING_USD,
        shipping_inr: parseFloat(shippingInr.toFixed(2)),
        total_price_usd: Math.round((variant.price_usd || 0) + SHIPPING_USD),
        total_price_inr: parseFloat(((variant.price_inr || 0) + shippingInr).toFixed(2)),
        image: selectedProduct.image
      });
      localStorage.setItem('cart', JSON.stringify(cart));
      showToast(`${selectedProduct.name} (${variant.pack}) added to cart.`);
    }

    function consultDoctor() {
      if (!selectedProduct) return;
      window.location.href = `doctor-consultation.html?product=${encodeURIComponent(selectedProduct.name)}`;
    }

    function getQueryProduct() {
      const params = new URLSearchParams(window.location.search);
      return params.get('product') || params.get('name');
    }

    async function loadProductDetails() {
      try {
        const res = await fetch('products-data.json');
        allProducts = await res.json();
        const productParam = decodeURIComponent(getQueryProduct() || '').trim();
        const product = allProducts.find((p) => p.name.toLowerCase() === productParam.toLowerCase());

        if (!product) {
          document.querySelector('main').innerHTML = '<div class="text-center py-20 text-slate-600 text-lg">Product not found.</div>';
          mobileActionBar.classList.add('hidden');
          return;
        }

        renderProduct(product);
        renderRelated(product);
        renderPairings(product);
      } catch (error) {
        console.error('Error loading product details', error);
      }
    }

      function bindEvents() {
      packSelect.addEventListener('change', updatePrice);
      document.getElementById('addToCartBtn').addEventListener('click', addToCart);
      document.getElementById('consultBtn').addEventListener('click', consultDoctor);
    }

    document.addEventListener('currency:change', () => {
      if (selectedProduct) {
        renderSelectors(selectedProduct);
      }
    });

    async function loadHeader() {
      const header = await fetch('header.html');
      document.getElementById('header-placeholder').innerHTML = await header.text();
      const menuBtn = document.getElementById('menu-btn');
      const closeBtn = document.getElementById('close-menu');
      const mobileMenu = document.getElementById('mobile-menu');
      const sidebar = document.getElementById('sidebar');
      if (!menuBtn || !sidebar || !mobileMenu) return;
      menuBtn.addEventListener('click', () => {
        mobileMenu.classList.remove('hidden');
        setTimeout(() => sidebar.classList.remove('translate-x-full'), 10);
      });
      closeBtn.addEventListener('click', () => {
        sidebar.classList.add('translate-x-full');
        setTimeout(() => mobileMenu.classList.add('hidden'), 300);
      });
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) {
          sidebar.classList.add('translate-x-full');
          setTimeout(() => mobileMenu.classList.add('hidden'), 300);
        }
      });
    }

    document.addEventListener('DOMContentLoaded', () => {
      bindEvents();
      loadProductDetails();
      loadHeader();
    });
  </script>
  <script type="module" src="firebase-config.js"></script>
</body>
</html>


